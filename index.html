<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Pembelajaran Interaktif IPA Kelas 7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .chapter-card, .quiz-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .chapter-card:hover, .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.5); /* Black w/ opacity */
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; /* Adjusted margin for better view */
            padding: 2rem;
            border: 1px solid #888;
            width: 90%;
            max-width: 800px;
            border-radius: 10px;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from {opacity: 0;}
            to {opacity: 1;}
        }
        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close-btn:hover,
        .close-btn:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        .quiz-option {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .quiz-option.selected {
            background-color: #dbeafe; /* blue-100 */
        }
        .quiz-option.correct {
            background-color: #d1fae5; /* green-100 */
            border-color: #10b981; /* green-500 */
        }
        .quiz-option.incorrect {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444; /* red-500 */
        }
        #quiz-feedback, #essay-feedback {
            display: none;
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
        }
        .prose h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .prose .formula {
            background-color: #eef2ff;
            padding: 1rem;
            border-left: 4px solid #4f46e5;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.1rem;
            font-weight: bold;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }
        .prose .example-box {
             background-color: #f3f4f6;
             border: 1px solid #d1d5db;
             padding: 1rem;
             margin-top: 1rem;
             border-radius: 0.5rem;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-md p-4 sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold text-blue-600">Belajar IPA Kelas 7</h1>
            <div class="w-1/2 md:w-1/3">
                <input type="search" id="search-input" placeholder="Cari materi..." class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container mx-auto p-4 md:p-8">
        <div id="search-results"></div>
        <div id="home-content">
            <h2 class="text-3xl font-bold mb-6 text-center text-gray-700">Selamat Datang di Portal Belajar IPA!</h2>
            <p class="text-center mb-8 text-gray-600">Pilih bab untuk mulai belajar atau coba kuis untuk menguji pemahamanmu.</p>

            <!-- Chapter Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="chapter-grid">
                <!-- Chapter cards will be inserted here by JS -->
            </div>

            <!-- Quiz Section -->
            <div class="mt-12 text-center">
                <h3 class="text-2xl font-bold mb-4 text-gray-700">Uji Pemahamanmu</h3>
                <div class="flex justify-center gap-4">
                    <button onclick="startQuiz('multiple-choice')" class="quiz-card bg-blue-500 text-white font-bold py-4 px-8 rounded-lg shadow-lg">Mulai Kuis Pilihan Ganda</button>
                    <button onclick="startQuiz('essay')" class="quiz-card bg-green-500 text-white font-bold py-4 px-8 rounded-lg shadow-lg">Mulai Kuis Esai</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for Chapter Content -->
    <div id="chapter-modal" class="modal">
        <div class="modal-content relative">
            <span class="close-btn absolute top-4 right-6" onclick="closeModal('chapter-modal')">&times;</span>
            <div id="modal-body" class="prose max-w-none"></div>
        </div>
    </div>

    <!-- Modal for Quiz -->
    <div id="quiz-modal" class="modal">
        <div class="modal-content">
             <span class="close-btn" onclick="closeModal('quiz-modal')">&times;</span>
            <div id="quiz-container">
                <h2 id="quiz-title" class="text-2xl font-bold mb-4"></h2>
                <div id="quiz-progress" class="mb-4 text-sm text-gray-600"></div>
                <div id="quiz-content"></div>
                <div class="mt-6 flex justify-between">
                    <button id="prev-question-btn" onclick="prevQuestion()" class="bg-gray-400 text-white font-bold py-2 px-4 rounded-lg hidden">Sebelumnya</button>
                    <button id="next-question-btn" onclick="nextQuestion()" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-lg">Selanjutnya</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const chapters = [
            {
                title: "Bab 1: Hakikat Ilmu Sains dan Metode Ilmiah",
                content: `
                    <h3 class='text-2xl font-bold mb-4'>Bab 1: Hakikat Ilmu Sains dan Metode Ilmiah</h3>
                    <div class='space-y-6'>
                        <div>
                            <h4>Pengantar</h4>
                            <p>Sains adalah ilmu pengetahuan sistematis tentang alam dan dunia fisik, yang diperoleh melalui observasi dan eksperimen. Bab ini memperkenalkan cabang-cabang Sains (Biologi, Fisika, Kimia, dll.), metode kerja ilmuwan, dan pentingnya pengukuran.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Metode Ilmiah</strong> adalah kerangka kerja logis yang digunakan untuk penelitian. Langkah-langkahnya adalah:</p>
                            <ol class='list-decimal list-inside space-y-2'>
                                <li><strong>Observasi:</strong> Mengamati fenomena secara kualitatif (deskripsi) dan kuantitatif (angka).</li>
                                <li><strong>Hipotesis:</strong> Membuat dugaan atau prediksi ilmiah yang bisa diuji.</li>
                                <li><strong>Eksperimen:</strong> Merancang dan melakukan percobaan terkontrol untuk menguji hipotesis. Ini melibatkan identifikasi <strong>variabel bebas</strong> (yang diubah), <strong>variabel terikat</strong> (yang diukur), dan <strong>variabel kontrol</strong> (yang dijaga tetap).</li>
                                <li><strong>Analisis Data:</strong> Mengolah data yang terkumpul ke dalam tabel dan grafik untuk melihat pola atau hubungan.</li>
                                <li><strong>Kesimpulan:</strong> Menarik kesimpulan apakah data mendukung atau menolak hipotesis, dan melaporkan hasilnya.</li>
                            </ol>
                            <p><strong>Pengukuran, Besaran, dan Satuan:</strong> Pengukuran adalah inti dari data kuantitatif. <strong>Besaran</strong> adalah segala sesuatu yang dapat diukur (cth: panjang, massa, waktu). <strong>Satuan</strong> adalah pembanding dalam pengukuran (cth: meter, kilogram, sekon). Ada 7 <strong>besaran pokok</strong> (panjang, massa, waktu, suhu, kuat arus, intensitas cahaya, jumlah zat) dan banyak <strong>besaran turunan</strong> (cth: luas, volume, kecepatan).</p>
                        </div>
                        <div>
                            <h4>Contoh</h4>
                            <p>Seorang siswa ingin mengetahui "Apakah jumlah pupuk mempengaruhi tinggi tanaman?". Dalam rancangan eksperimennya, ia harus mengontrol faktor lain agar hasilnya valid.
                            <br>- <strong>Variabel Bebas:</strong> Jumlah pupuk (misalnya pot A tanpa pupuk, pot B dengan 5 gram pupuk, pot C dengan 10 gram).
                            <br>- <strong>Variabel Terikat:</strong> Tinggi tanaman yang diukur setiap minggu.
                            <br>- <strong>Variabel Kontrol:</strong> Jenis tanaman yang sama, volume air penyiraman yang sama, paparan cahaya matahari yang sama, dan jenis tanah yang sama untuk semua pot.</p>
                        </div>
                        <div>
                            <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Jarak antara kota A dan B adalah 15 kilometer. Berapa jarak tersebut dalam satuan Standar Internasional (SI)?</p>
                                <p><strong>Pembahasan:</strong></p>
                                <ol class='list-decimal list-inside'>
                                    <li>Satuan SI untuk panjang adalah meter (m).</li>
                                    <li>Kita perlu mengonversi kilometer (km) ke meter (m).</li>
                                    <li>Diketahui 1 km = 1000 m.</li>
                                    <li>Maka, 15 km = 15 × 1000 m = 15.000 m.</li>
                                </ol>
                                <p><strong>Jawaban:</strong> Jaraknya adalah 15.000 meter.</p>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Bab 2: Zat dan Perubahannya",
                content: `
                    <h3 class='text-2xl font-bold mb-4'>Bab 2: Zat dan Perubahannya</h3>
                    <div class='space-y-6'>
                        <div>
                            <h4>Pengantar</h4>
                            <p>Materi atau zat adalah segala sesuatu yang memiliki massa dan menempati ruang. Zat dapat berwujud padat, cair, atau gas, dan dapat mengalami berbagai perubahan. Bab ini mengupas tuntas sifat zat dan perubahannya.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Wujud Zat & Model Partikel:</strong></p>
                            <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Padat:</strong> Partikel tersusun sangat rapat dan teratur, ikatannya sangat kuat, sehingga bentuk dan volumenya tetap. Partikel hanya bisa bergetar.</li>
                                <li><strong>Cair:</strong> Partikelnya rapat tapi tidak teratur, ikatan lebih lemah, sehingga bisa bergerak mengalir. Volumenya tetap, tapi bentuknya mengikuti wadah.</li>
                                <li><strong>Gas:</strong> Jarak antar partikel sangat jauh, bergerak sangat bebas dan acak, ikatannya sangat lemah. Bentuk dan volumenya selalu mengisi seluruh ruang wadah.</li>
                            </ul>
                            <p><strong>Perubahan Fisika vs. Kimia:</strong></p>
                             <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Perubahan Fisika:</strong> Perubahan yang tidak menghasilkan zat jenis baru. Meliputi perubahan wujud (mencair, membeku, menguap) dan perubahan bentuk (melarutkan gula, memotong kayu). Sifatnya reversibel (dapat kembali).</li>
                                <li><strong>Perubahan Kimia (Reaksi Kimia):</strong> Perubahan yang menghasilkan zat jenis baru dengan sifat yang sama sekali berbeda. Contoh: pembakaran, perkaratan, pembusukan. Sifatnya ireversibel (tidak dapat kembali).</li>
                             </ul>
                        </div>
                        <div>
                            <h4>Contoh</h4>
                            <p>Siklus air di alam adalah contoh perubahan fisika skala besar: air laut <strong>menguap</strong> (cair ke gas), uap air <strong>mengembun</strong> (gas ke cair) menjadi awan, dan turun sebagai hujan (cair). Jika suhu sangat dingin, air dapat <strong>membeku</strong> (cair ke padat) menjadi es. Semua proses ini hanya mengubah wujud air (H₂O), bukan zatnya. Sebaliknya, pembakaran kayu menjadi arang adalah contoh perubahan kimia yang jelas.</p>
                        </div>
                        <div>
                            <h4>Rumus Penting</h4>
                            <p class='formula'>Massa Jenis (Kerapatan): ρ = m / V</p>
                            <p>Dimana: <br> <strong>ρ (rho)</strong> = massa jenis (kg/m³ atau g/cm³)<br> <strong>m</strong> = massa (kg atau g)<br> <strong>V</strong> = volume (m³ atau cm³)</p>
                        </div>
                        <div>
                            <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Sebuah batu memiliki massa 150 gram. Ketika dimasukkan ke dalam gelas ukur berisi 100 mL air, permukaan air naik menjadi 150 mL. Berapakah massa jenis batu tersebut?</p>
                                <p><strong>Pembahasan:</strong></p>
                                <ol class='list-decimal list-inside'>
                                    <li><strong>Massa (m)</strong> batu = 150 g.</li>
                                    <li><strong>Volume (V)</strong> batu diukur dari kenaikan volume air. V = Volume akhir - Volume awal = 150 mL - 100 mL = 50 mL.</li>
                                    <li>Karena 1 mL = 1 cm³, maka V = 50 cm³.</li>
                                    <li>Gunakan rumus massa jenis: ρ = m / V.</li>
                                    <li>ρ = 150 g / 50 cm³ = 3 g/cm³.</li>
                                </ol>
                                <p><strong>Jawaban:</strong> Massa jenis batu tersebut adalah 3 g/cm³.</p>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Bab 3: Suhu, Kalor, dan Pemuaian",
                content: `
                    <h3 class='text-2xl font-bold mb-4'>Bab 3: Suhu, Kalor, dan Pemuaian</h3>
                    <div class='space-y-6'>
                        <div>
                            <h4>Pengantar</h4>
                            <p>Suhu dan kalor adalah dua konsep yang sering tertukar, namun berbeda. Bab ini menjelaskan perbedaan keduanya, cara kalor berpindah, dan efeknya berupa pemuaian.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Suhu vs Kalor:</strong></p>
                            <ul class='list-disc list-inside'>
                                <li><strong>Suhu:</strong> Ukuran derajat panas atau dinginnya suatu benda. Ini adalah sifat intrinsik benda. Alat ukurnya termometer.</li>
                                <li><strong>Kalor:</strong> Energi panas yang berpindah dari benda bersuhu lebih tinggi ke benda bersuhu lebih rendah. Jumlah energi yang ditransfer.</li>
                            </ul>
                            <p><strong>Perpindahan Kalor:</strong></p>
                            <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Konduksi:</strong> Perpindahan panas melalui zat padat tanpa disertai perpindahan partikelnya. Bahan yang baik disebut konduktor (logam), yang buruk disebut isolator (kayu, plastik).</li>
                                <li><strong>Konveksi:</strong> Perpindahan panas melalui fluida (cair atau gas) disertai perpindahan partikelnya membentuk aliran konveksi. Contoh: angin darat dan angin laut.</li>
                                <li><strong>Radiasi:</strong> Perpindahan panas dalam bentuk gelombang elektromagnetik tanpa memerlukan medium. Contoh: panas matahari.</li>
                            </ul>
                            <p><strong>Pemuaian:</strong> Fenomena bertambahnya ukuran benda (panjang, luas, atau volume) akibat menerima kalor. Besarnya pemuaian tergantung pada jenis zat (koefisien muai), ukuran awal, dan perubahan suhu.</p>
                        </div>
                         <div>
                            <h4>Contoh</h4>
                            <p>Termos dirancang secara cerdas untuk menghambat ketiga jenis perpindahan kalor. Ruang hampa di antara dua dindingnya mencegah <strong>konduksi</strong> dan <strong>konveksi</strong>. Sementara itu, lapisan perak mengkilap di dinding bagian dalam berfungsi untuk memantulkan kembali panas yang mencoba keluar melalui <strong>radiasi</strong>. Inilah sebabnya air panas di dalam termos bisa tetap panas untuk waktu yang lama.</p>
                        </div>
                        <div>
                            <h4>Rumus Penting</h4>
                            <p class='formula'>Perpindahan Kalor: Q = m · c · ΔT</p>
                            <p>Dimana: <br> <strong>Q</strong> = Kalor yang diterima/dilepas (Joule)<br> <strong>m</strong> = massa benda (kg)<br> <strong>c</strong> = kalor jenis benda (J/kg°C)<br> <strong>ΔT</strong> = perubahan suhu (°C)</p>
                        </div>
                        <div>
                            <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Berapa banyak kalor yang dibutuhkan untuk memanaskan 2 kg air dari suhu 20°C menjadi 70°C? (Kalor jenis air = 4200 J/kg°C)</p>
                                <p><strong>Pembahasan:</strong></p>
                                <ol class='list-decimal list-inside'>
                                    <li><strong>Massa (m)</strong> = 2 kg.</li>
                                    <li><strong>Kalor jenis (c)</strong> = 4200 J/kg°C.</li>
                                    <li><strong>Perubahan suhu (ΔT)</strong> = Suhu akhir - Suhu awal = 70°C - 20°C = 50°C.</li>
                                    <li>Gunakan rumus: Q = m · c · ΔT.</li>
                                    <li>Q = 2 kg · 4200 J/kg°C · 50°C = 420.000 Joule atau 420 kJ.</li>
                                </ol>
                                <p><strong>Jawaban:</strong> Kalor yang dibutuhkan adalah 420.000 Joule.</p>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Bab 4: Gerak dan Gaya",
                content: `
                    <h3 class='text-2xl font-bold mb-4'>Bab 4: Gerak dan Gaya</h3>
                    <div class='space-y-6'>
                        <div>
                            <h4>Pengantar</h4>
                            <p>Dunia di sekitar kita penuh dengan gerakan. Bab ini akan membahas deskripsi gerak (kinematika) dan penyebab gerak (dinamika), yang dijelaskan oleh Hukum Newton.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Konsep Gerak:</strong> Suatu benda dikatakan bergerak jika posisinya berubah terhadap suatu titik acuan.</p>
                             <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Jarak vs Perpindahan:</strong> Jarak adalah total lintasan yang ditempuh (besaran skalar). Perpindahan adalah perubahan posisi akhir dari posisi awal dan memiliki arah (besaran vektor).</li>
                                <li><strong>Kelajuan vs Kecepatan:</strong> Kelajuan adalah jarak dibagi waktu (skalar). Kecepatan adalah perpindahan dibagi waktu (vektor).</li>
                             </ul>
                             <p><strong>Hukum Newton tentang Gerak:</strong></p>
                             <ol class='list-decimal list-inside space-y-2'>
                                 <li><strong>Hukum I Newton (Kelembaman):</strong> Jika resultan gaya ($\Sigma$F) pada benda adalah nol, benda yang diam akan tetap diam, dan benda yang bergerak akan terus bergerak dengan kecepatan konstan.</li>
                                 <li><strong>Hukum II Newton:</strong> Percepatan (a) yang dialami benda berbanding lurus dengan resultan gaya ($\Sigma$F) dan berbanding terbalik dengan massanya (m).</li>
                                 <li><strong>Hukum III Newton (Aksi-Reaksi):</strong> Jika benda A memberikan gaya pada benda B (aksi), maka benda B akan memberikan gaya yang sama besar namun berlawanan arah pada benda A (reaksi).</li>
                             </ol>
                        </div>
                        <div>
                            <h4>Contoh</h4>
                            <p>Saat mobil direm mendadak, tubuh kita terdorong ke depan. Ini adalah contoh <strong>Hukum I Newton (inersia)</strong>, di mana tubuh kita cenderung mempertahankan keadaan geraknya. Mendorong meja adalah aplikasi <strong>Hukum II Newton</strong>; semakin kuat dorongan (gaya), semakin cepat meja bergerak (percepatan). Saat kita mendayung perahu, dayung mendorong air ke belakang (aksi) dan sebagai hasilnya perahu bergerak maju (reaksi), ini adalah contoh <strong>Hukum III Newton</strong>.</p>
                        </div>
                        <div>
                            <h4>Rumus Penting</h4>
                            <p class='formula'>Kelajuan: v = s / t</p>
                            <p class='formula'>Percepatan: a = Δv / t = (v_akhir - v_awal) / t</p>
                            <p class='formula'>Hukum II Newton: ΣF = m · a</p>
                        </div>
                        <div>
                            <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Sebuah balok bermassa 5 kg didorong dengan gaya 20 N. Berapakah percepatan yang dialami balok tersebut (abaikan gesekan)?</p>
                                <p><strong>Pembahasan:</strong></p>
                                <ol class='list-decimal list-inside'>
                                    <li><strong>Massa (m)</strong> = 5 kg.</li>
                                    <li><strong>Gaya (F)</strong> = 20 N.</li>
                                    <li>Gunakan rumus Hukum II Newton: F = m · a, maka a = F / m.</li>
                                    <li>a = 20 N / 5 kg = 4 m/s².</li>
                                </ol>
                                <p><strong>Jawaban:</strong> Percepatan balok adalah 4 m/s².</p>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Bab 5: Klasifikasi Makhluk Hidup",
                content: `
                    <h3 class='text-2xl font-bold mb-4'>Bab 5: Klasifikasi Makhluk Hidup</h3>
                    <div class='space-y-6'>
                        <div>
                           <h4>Pengantar</h4>
                           <p>Untuk mempelajari keanekaragaman makhluk hidup yang luar biasa, para ilmuwan mengelompokkannya dalam sistem klasifikasi. Bab ini menjelaskan dasar-dasar pengelompokan tersebut.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Tujuan Klasifikasi:</strong> Menyederhanakan objek studi, mengetahui hubungan kekerabatan, dan memberi nama ilmiah.</p>
                            <p><strong>Taksonomi:</strong> Ilmu klasifikasi makhluk hidup. Tingkatan takson dari tertinggi ke terendah adalah: <strong>Kingdom (Kerajaan) → Filum/Divisi → Kelas → Ordo (Bangsa) → Famili (Suku) → Genus (Marga) → Spesies (Jenis)</strong>. Semakin rendah tingkatannya, semakin banyak persamaan cirinya.</p>
                            <p><strong>Sistem Lima Kingdom:</strong></p>
                            <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Monera:</strong> Bersel satu, prokariotik (inti sel tanpa membran). Contoh: Bakteri, Alga biru.</li>
                                <li><strong>Protista:</strong> Eukariotik (inti sel bermembran), umumnya bersel satu. Ada yang mirip hewan (Protozoa), mirip tumbuhan (Alga), dan mirip jamur (jamur lendir).</li>
                                <li><strong>Fungi (Jamur):</strong> Eukariotik, tidak berklorofil (heterotrof), mendapatkan makanan dengan mengurai sisa organisme lain (saprofit).</li>
                                <li><strong>Plantae (Tumbuhan):</strong> Eukariotik, multiseluler, memiliki klorofil (autotrof), dapat berfotosintesis. Dibagi menjadi lumut, paku, dan tumbuhan berbiji.</li>
                                <li><strong>Animalia (Hewan):</strong> Eukariotik, multiseluler, tidak memiliki dinding sel, heterotrof. Dibagi menjadi Vertebrata (bertulang belakang) dan Avertebrata (tidak bertulang belakang).</li>
                            </ul>
                        </div>
                        <div>
                            <h4>Contoh</h4>
                            <p>Kucing domestik (<em>Felis catus</em>) dan Harimau (<em>Panthera tigris</em>) sama-sama berada dalam Famili Felidae karena memiliki banyak ciri yang sama (karnivora, cakar dapat ditarik masuk, dll.). Namun, mereka berada dalam Genus yang berbeda (<em>Felis</em> dan <em>Panthera</em>) dan Spesies yang berbeda, menunjukkan adanya perbedaan ciri yang lebih spesifik di antara keduanya.</p>
                        </div>
                         <div>
                            <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Menggunakan kunci dikotomi sederhana di bawah, tentukan kelompok untuk kucing.</p>
                                <p>1. a. Bertulang belakang ..... lanjut ke 2<br> &nbsp;&nbsp;&nbsp;&nbsp;b. Tidak bertulang belakang ..... Avertebrata<br>
                                   2. a. Menyusui anaknya ..... Mamalia<br> &nbsp;&nbsp;&nbsp;&nbsp;b. Tidak menyusui anaknya ..... lanjut ke 3
                                </p>
                                <p><strong>Pembahasan:</strong></p>
                                <ol class='list-decimal list-inside'>
                                    <li>Kucing memiliki tulang belakang, jadi pilih 1a dan lanjut ke nomor 2.</li>
                                    <li>Kucing menyusui anaknya, jadi pilih 2a.</li>
                                    <li>Hasilnya adalah Mamalia.</li>
                                </ol>
                                <p><strong>Jawaban:</strong> Kucing termasuk dalam kelompok Mamalia.</p>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Bab 6: Ekologi dan Keanekaragaman Hayati",
                content: `
                     <h3 class='text-2xl font-bold mb-4'>Bab 6: Ekologi dan Keanekaragaman Hayati Indonesia</h3>
                    <div class='space-y-6'>
                        <div>
                            <h4>Pengantar</h4>
                            <p>Ekologi adalah ilmu tentang hubungan timbal balik antara makhluk hidup dan lingkungannya. Indonesia, sebagai negara megabiodiversitas, memiliki ekosistem yang unik dan kaya namun juga rentan.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Satuan dalam Ekosistem:</strong> Individu → Populasi → Komunitas → Ekosistem → Bioma → Biosfer.</p>
                            <p><strong>Aliran Energi:</strong> Energi mengalir dalam satu arah melalui <strong>rantai makanan</strong>. Dimulai dari <strong>produsen</strong> (tumbuhan), ke <strong>konsumen I</strong> (herbivora), <strong>konsumen II</strong> (karnivora), dan seterusnya. Kumpulan rantai makanan membentuk <strong>jaring-jaring makanan</strong>.</p>
                            <p><strong>Interaksi Antarspesies (Simbiosis):</strong></p>
                            <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Mutualisme (+/+):</strong> Keduanya untung (cth: lebah dan bunga).</li>
                                <li><strong>Komensalisme (+/0):</strong> Satu untung, yang lain tidak terpengaruh (cth: anggrek di pohon).</li>
                                <li><strong>Parasitisme (+/-):</strong> Satu untung (parasit), yang lain rugi (inang) (cth: benalu di pohon mangga).</li>
                                <li><strong>Kompetisi (-/-):</strong> Keduanya rugi karena memperebutkan sumber daya yang sama.</li>
                            </ul>
                             <p><strong>Konservasi:</strong> Upaya perlindungan dan pelestarian. Dilakukan secara <strong>in-situ</strong> (di habitat asli, cth: Cagar Alam, Taman Nasional) dan <strong>ex-situ</strong> (di luar habitat asli, cth: Kebun Raya, Kebun Binatang).</p>
                        </div>
                        <div>
                            <h4>Contoh</h4>
                            <p>Hubungan antara lebah dan bunga adalah simbiosis mutualisme yang klasik. Lebah mendapatkan nektar sebagai makanan, sementara bunga dibantu dalam proses penyerbukannya. Di sisi lain, pembukaan lahan perkebunan kelapa sawit secara besar-besaran sering kali menyebabkan deforestasi, yang merupakan contoh kerusakan habitat yang mengancam kelangsungan hidup spesies seperti orang utan.</p>
                        </div>
                        <div>
                            <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Dalam ekosistem sawah, terdapat padi, tikus, ular, dan elang. Buatlah satu rantai makanan dan sebutkan peran masing-masing organisme!</p>
                                <p><strong>Pembahasan:</strong></p>
                                <p>Rantai makanan yang mungkin terbentuk:</p>
                                <p class='font-bold'>Padi → Tikus → Ular → Elang</p>
                                <ul class='list-disc list-inside'>
                                    <li><strong>Padi:</strong> Berperan sebagai Produsen (penghasil makanan).</li>
                                    <li><strong>Tikus:</strong> Berperan sebagai Konsumen I (memakan produsen).</li>
                                    <li><strong>Ular:</strong> Berperan sebagai Konsumen II (memakan konsumen I).</li>
                                    <li><strong>Elang:</strong> Berperan sebagai Konsumen III atau Konsumen Puncak.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Bab 7: Bumi dan Tata Surya",
                content: `
                    <h3 class='text-2xl font-bold mb-4'>Bab 7: Bumi dan Tata Surya</h3>
                    <div class='space-y-6'>
                        <div>
                            <h4>Pengantar</h4>
                            <p>Bumi adalah planet kita, bagian dari sistem tata surya yang sangat luas. Pergerakan Bumi dan benda langit lain di sekitarnya menimbulkan berbagai fenomena alam yang kita alami setiap hari.</p>
                        </div>
                        <div>
                            <h4>Penjelasan</h4>
                            <p><strong>Tata Surya:</strong> Terdiri dari Matahari sebagai bintang pusat, delapan planet, planet kerdil, satelit, asteroid, dan komet. Urutan planet dari terdekat Matahari: Merkurius, Venus, Bumi, Mars, Jupiter, Saturnus, Uranus, Neptunus.</p>
                            <p><strong>Gerak Bumi dan Akibatnya:</strong></p>
                            <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Rotasi Bumi:</strong> Perputaran Bumi pada porosnya dalam waktu 24 jam. Akibatnya: terjadinya siang dan malam, gerak semu harian benda langit, perbedaan waktu di berbagai belahan dunia.</li>
                                <li><strong>Revolusi Bumi:</strong> Peredaran Bumi mengelilingi Matahari dalam waktu 365,25 hari. Akibatnya: pergantian musim, perubahan rasi bintang yang terlihat, gerak semu tahunan Matahari.</li>
                            </ul>
                            <p><strong>Bulan dan Gerhana:</strong></p>
                             <ul class='list-disc list-inside space-y-2'>
                                <li><strong>Bulan:</strong> Satelit alami Bumi yang berevolusi mengelilingi Bumi. Gerakannya menyebabkan fase-fase Bulan dan pasang surut air laut.</li>
                                <li><strong>Gerhana Bulan:</strong> Terjadi saat Bulan purnama ketika Bumi berada di antara Matahari dan Bulan, sehingga bayangan Bumi menutupi Bulan.</li>
                                <li><strong>Gerhana Matahari:</strong> Terjadi saat bulan baru ketika Bulan berada di antara Matahari dan Bumi, sehingga Bulan menutupi cahaya Matahari.</li>
                             </ul>
                        </div>
                        <div>
                            <h4>Contoh</h4>
                            <p>Di negara-negara empat musim, saat Belahan Bumi Utara mengalami musim dingin, poros bumi di bagian utara sedang condong menjauhi matahari. Akibatnya, wilayah ini menerima sinar matahari lebih sedikit dan miring, sehingga suhu menjadi dingin dan waktu siang lebih pendek. Sebaliknya, Belahan Bumi Selatan sedang mengalami musim panas karena posisinya condong ke arah matahari.</p>
                        </div>
                        <div>
                             <h4>Contoh Soal dan Pembahasan</h4>
                            <div class='example-box'>
                                <p><strong>Soal:</strong> Saat Belahan Bumi Utara mengalami musim panas, musim apakah yang dialami oleh Belahan Bumi Selatan? Mengapa?</p>
                                <p><strong>Pembahasan:</strong></p>
                                <ol class='list-decimal list-inside'>
                                    <li>Pergantian musim disebabkan oleh revolusi Bumi dan kemiringan sumbunya.</li>
                                    <li>Ketika Belahan Bumi Utara (BBU) condong ke arah Matahari, BBU menerima sinar matahari secara lebih tegak lurus dan lebih lama, sehingga mengalami musim panas.</li>
                                    <li>Pada saat yang sama, Belahan Bumi Selatan (BBS) condong menjauhi Matahari. BBS menerima sinar matahari secara lebih miring, sehingga mengalami musim dingin.</li>
                                </ol>
                                <p><strong>Jawaban:</strong> Belahan Bumi Selatan mengalami musim dingin.</p>
                            </div>
                        </div>
                    </div>
                `
            }
        ];

        const multipleChoiceQuiz = [
            {
                question: "Seorang ilmuwan ingin menguji pengaruh jenis tanah (tanah liat, pasir, humus) terhadap kecepatan pertumbuhan tanaman kacang. Apa yang menjadi variabel bebas dalam percobaan ini?",
                options: ["Kecepatan pertumbuhan tanaman", "Jenis tanaman kacang", "Jenis tanah", "Jumlah air yang disiram"],
                answer: "Jenis tanah",
                explanation: "Variabel bebas adalah faktor yang sengaja diubah atau dibedakan oleh peneliti untuk dilihat pengaruhnya. Dalam kasus ini, yang diubah-ubah adalah jenis tanah."
            },
            {
                question: "Perubahan wujud dari gas menjadi cair disebut...",
                options: ["Menguap", "Membeku", "Mengembun", "Menyublim"],
                answer: "Mengembun",
                explanation: "Mengembun adalah proses perubahan wujud dari gas menjadi cair, contohnya titik-titik air di bagian luar gelas yang berisi es."
            },
            {
                question: "Panas dari api unggun bisa kita rasakan meskipun kita tidak menyentuhnya secara langsung. Proses perpindahan kalor ini terjadi melalui...",
                options: ["Konduksi", "Konveksi", "Radiasi", "Isolasi"],
                answer: "Radiasi",
                explanation: "Radiasi adalah perpindahan panas tanpa memerlukan medium atau perantara. Panas dari api unggun dan matahari sampai ke kita melalui radiasi."
            },
            {
                question: "Sebuah mobil bergerak ke timur sejauh 100 meter, kemudian berbalik arah ke barat sejauh 40 meter. Berapakah perpindahan mobil tersebut?",
                options: ["140 meter ke timur", "60 meter ke timur", "140 meter ke barat", "60 meter ke barat"],
                answer: "60 meter ke timur",
                explanation: "Perpindahan adalah perubahan posisi dari titik awal ke titik akhir. Jika ke timur positif (+) dan ke barat negatif (-), maka perpindahannya adalah +100 m - 40 m = +60 m atau 60 meter ke timur."
            },
            {
                question: "Makhluk hidup yang dapat membuat makanannya sendiri melalui fotosintesis, seperti tumbuhan, dikelompokkan sebagai...",
                options: ["Konsumen", "Produsen", "Dekomposer", "Heterotrof"],
                answer: "Produsen",
                explanation: "Produsen (atau autotrof) adalah organisme yang dapat menghasilkan makanannya sendiri, biasanya melalui fotosintesis. Tumbuhan adalah contoh utama produsen."
            },
            {
                question: "Hubungan antara lebah yang mengambil nektar dari bunga dan sekaligus membantu penyerbukan bunga tersebut adalah contoh dari simbiosis...",
                options: ["Parasitisme", "Komensalisme", "Mutualisme", "Amensalisme"],
                answer: "Mutualisme",
                explanation: "Simbiosis mutualisme adalah hubungan yang saling menguntungkan kedua belah pihak. Lebah mendapat makanan, dan bunga dibantu penyerbukannya."
            },
            {
                question: "Terjadinya siang dan malam di Bumi disebabkan oleh...",
                options: ["Revolusi Bumi", "Rotasi Bumi", "Revolusi Bulan", "Kemiringan sumbu Bumi"],
                answer: "Rotasi Bumi",
                explanation: "Rotasi Bumi adalah perputaran Bumi pada porosnya. Sisi Bumi yang menghadap Matahari mengalami siang, dan sisi yang membelakangi Matahari mengalami malam."
            },
            {
                question: "Manakah urutan takson dari yang paling tinggi (umum) ke yang paling rendah (spesifik) yang benar?",
                options: ["Spesies, Genus, Famili, Ordo, Kelas", "Kingdom, Filum, Kelas, Ordo, Famili", "Kelas, Ordo, Famili, Genus, Kingdom", "Filum, Kelas, Ordo, Spesies, Famili"],
                answer: "Kingdom, Filum, Kelas, Ordo, Famili",
                explanation: "Urutan taksonomi yang benar dari tingkatan tertinggi ke terendah adalah Kingdom, Filum/Divisi, Kelas, Ordo, Famili, Genus, Spesies."
            },
            {
                question: "Saat air dipanaskan hingga mendidih, partikel-partikel air akan...",
                options: ["Bergerak lebih lambat dan merapat", "Hanya bergetar di tempat", "Bergerak lebih cepat dan saling menjauh", "Kehilangan semua energinya"],
                answer: "Bergerak lebih cepat dan saling menjauh",
                explanation: "Pemanasan memberikan energi pada partikel, membuatnya bergerak lebih cepat dan mengatasi gaya tarik antar partikel, sehingga berubah dari wujud cair menjadi gas (uap air)."
            },
            {
                question: "Berikut ini yang merupakan contoh perubahan kimia adalah...",
                options: ["Lilin meleleh", "Air membeku", "Besi berkarat", "Gula larut dalam air"],
                answer: "Besi berkarat",
                explanation: "Besi berkarat adalah perubahan kimia karena besi (Fe) bereaksi dengan oksigen dan air membentuk zat baru, yaitu karat besi (Fe2O3.nH2O), dengan sifat yang berbeda dari besi."
            },
            {
                question: "Gerhana Bulan terjadi ketika posisi...",
                options: ["Bumi berada di antara Matahari dan Bulan", "Bulan berada di antara Matahari dan Bumi", "Matahari berada di antara Bumi dan Bulan", "Bumi, Bulan, dan Matahari membentuk sudut 90 derajat"],
                answer: "Bumi berada di antara Matahari dan Bulan",
                explanation: "Gerhana Bulan terjadi saat Bumi menghalangi cahaya Matahari sehingga tidak sampai ke Bulan. Ini hanya bisa terjadi saat Bumi berada di antara Matahari dan Bulan."
            },
             {
                question: "Hewan khas Indonesia yang termasuk dalam fauna tipe Peralihan (zona Wallacea) adalah...",
                options: ["Orang utan", "Anoa", "Kanguru Pohon", "Gajah Sumatera"],
                answer: "Anoa",
                explanation: "Fauna tipe Peralihan adalah hewan endemik yang berada di wilayah antara Garis Wallace dan Garis Webber, seperti Sulawesi. Anoa adalah hewan khas Sulawesi."
            },
            {
                question: "Alat laboratorium yang berfungsi untuk mengukur volume cairan dengan akurat adalah...",
                options: ["Gelas kimia (beaker glass)", "Labu Erlenmeyer", "Tabung reaksi", "Gelas ukur"],
                answer: "Gelas ukur",
                explanation: "Gelas ukur dirancang khusus dengan skala volume yang detail untuk pengukuran volume cairan secara akurat."
            },
            {
                question: "Pemasangan kabel listrik di tiang-tiang dibuat sedikit kendor. Hal ini bertujuan untuk...",
                options: ["Menghemat biaya kabel", "Mengantisipasi penyusutan saat suhu dingin", "Memperindah pemandangan", "Memudahkan perbaikan"],
                answer: "Mengantisipasi penyusutan saat suhu dingin",
                explanation: "Pada suhu dingin (malam hari), kabel akan menyusut (memendek). Jika dipasang terlalu kencang, kabel bisa putus saat menyusut."
            },
            {
                question: "Seorang pengendara motor menempuh jarak 180 km dalam waktu 3 jam. Kelajuan rata-rata pengendara motor tersebut adalah...",
                options: ["50 km/jam", "60 km/jam", "70 km/jam", "90 km/jam"],
                answer: "60 km/jam",
                explanation: "Kelajuan dihitung dengan membagi jarak dengan waktu. Kelajuan = 180 km / 3 jam = 60 km/jam."
            },
            {
                question: "Contoh organisme yang termasuk dalam Kingdom Monera adalah...",
                options: ["Amoeba", "Jamur Tiram", "Bakteri E. coli", "Tanaman Paku"],
                answer: "Bakteri E. coli",
                explanation: "Kingdom Monera beranggotakan organisme prokariotik (tanpa membran inti sel), contohnya adalah bakteri."
            },
            {
                question: "Dalam sebuah rantai makanan, elang yang memangsa ular berperan sebagai...",
                options: ["Produsen", "Konsumen I", "Konsumen II", "Konsumen puncak"],
                answer: "Konsumen puncak",
                explanation: "Dalam rantai makanan: Padi -> Tikus -> Ular -> Elang. Elang berada di tingkat trofik tertinggi dan tidak memiliki predator alami, sehingga disebut konsumen puncak."
            },
            {
                question: "Planet yang dikenal sebagai 'Planet Merah' karena permukaannya yang kaya akan besi oksida adalah...",
                options: ["Venus", "Mars", "Jupiter", "Saturnus"],
                answer: "Mars",
                explanation: "Permukaan Mars yang kemerahan disebabkan oleh banyaknya debu besi oksida (karat) di permukaannya."
            },
            {
                question: "Peristiwa pasang surut air laut di Bumi paling dominan dipengaruhi oleh gaya gravitasi...",
                options: ["Matahari", "Bulan", "Jupiter", "Venus"],
                answer: "Bulan",
                explanation: "Meskipun Matahari jauh lebih besar, jarak Bulan yang sangat dekat dengan Bumi membuat gaya gravitasinya menjadi pengaruh utama terjadinya pasang surut air laut."
            },
            {
                question: "Upaya pelestarian orang utan dengan menempatkannya di Taman Nasional Tanjung Puting adalah contoh konservasi...",
                options: ["Ex-situ", "In-situ", "Domestikasi", "Hibridisasi"],
                answer: "In-situ",
                explanation: "Konservasi in-situ adalah upaya pelestarian makhluk hidup di habitat aslinya. Taman Nasional adalah salah satu bentuknya."
            }
        ];

        const essayQuiz = [
            {
                question: "Jelaskan langkah-langkah metode ilmiah secara berurutan dan berikan contoh singkat penerapannya!",
                answer: "Urutan metode ilmiah: 1. Observasi (melihat daun menguning), 2. Rumusan Masalah (mengapa daun kuning?), 3. Hipotesis (mungkin kekurangan air), 4. Eksperimen (menyiram satu tanaman secara rutin, yang lain tidak), 5. Analisis Data (tanaman yang disiram tetap hijau), 6. Kesimpulan (kekurangan air menyebabkan daun menguning)."
            },
            {
                question: "Bedakan antara perubahan fisika dan perubahan kimia, serta berikan masing-masing satu contoh!",
                answer: "Perubahan fisika tidak menghasilkan zat baru, hanya mengubah bentuk atau wujud (contoh: es mencair). Perubahan kimia menghasilkan zat baru dengan sifat berbeda (contoh: kayu dibakar menjadi arang). Perubahan fisika dapat kembali, sedangkan perubahan kimia tidak."
            },
            {
                question: "Jelaskan tiga cara perpindahan kalor (konduksi, konveksi, radiasi) beserta contohnya dalam kehidupan sehari-hari!",
                answer: "1. Konduksi: perpindahan panas melalui benda padat (contoh: gagang panci ikut panas saat memasak). 2. Konveksi: perpindahan panas melalui aliran zat cair/gas (contoh: gerakan air mendidih). 3. Radiasi: perpindahan panas tanpa perantara (contoh: panas matahari terasa di kulit)."
            },
            {
                question: "Apa perbedaan mendasar antara rantai makanan dan jaring-jaring makanan dalam sebuah ekosistem?",
                answer: "Rantai makanan adalah satu jalur tunggal aliran energi (misal: rumput-belalang-katak). Jaring-jaring makanan adalah kumpulan dari beberapa rantai makanan yang saling berhubungan, menunjukkan bahwa satu organisme bisa memakan atau dimakan oleh lebih dari satu jenis organisme lain, sehingga lebih kompleks dan realistis."
            },
            {
                question: "Mengapa terjadi pergantian musim di sebagian wilayah Bumi? Jelaskan kaitannya dengan gerak Bumi!",
                answer: "Pergantian musim disebabkan oleh revolusi Bumi (peredaran Bumi mengelilingi Matahari) dan kemiringan sumbu rotasi Bumi (23,5 derajat). Kemiringan ini menyebabkan sebagian belahan Bumi menerima sinar matahari lebih langsung (mengalami musim panas) sementara belahan lain menerima sinar lebih miring (mengalami musim dingin) secara bergantian sepanjang tahun."
            }
        ];

        let currentQuizData = [];
        let currentQuestionIndex = 0;
        let userAnswers = {}; // { 0: 'A', 1: 'C', ... }

        document.addEventListener('DOMContentLoaded', () => {
            const chapterGrid = document.getElementById('chapter-grid');
            chapters.forEach((chapter, index) => {
                const card = document.createElement('div');
                card.className = 'chapter-card bg-white p-6 rounded-lg shadow-md cursor-pointer';
                card.innerHTML = `<h3 class="font-bold text-lg text-gray-800">${chapter.title}</h3>`;
                card.onclick = () => showChapter(index);
                chapterGrid.appendChild(card);
            });

            document.getElementById('search-input').addEventListener('input', handleSearch);
        });

        function showChapter(index) {
            document.getElementById('modal-body').innerHTML = chapters[index].content;
            document.getElementById('chapter-modal').style.display = 'block';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        window.onclick = function(event) {
            const chapterModal = document.getElementById('chapter-modal');
            const quizModal = document.getElementById('quiz-modal');
            if (event.target == chapterModal) {
                chapterModal.style.display = "none";
            }
            if (event.target == quizModal) {
                quizModal.style.display = "none";
            }
        }

        function handleSearch(event) {
            const query = event.target.value.toLowerCase();
            const resultsContainer = document.getElementById('search-results');
            const homeContent = document.getElementById('home-content');

            if (query.length < 3) {
                resultsContainer.innerHTML = '';
                homeContent.style.display = 'block';
                return;
            }

            homeContent.style.display = 'none';
            resultsContainer.innerHTML = '';
            
            const results = chapters.filter(chapter => chapter.title.toLowerCase().includes(query) || chapter.content.toLowerCase().includes(query));

            if (results.length > 0) {
                resultsContainer.innerHTML = `<h2 class="text-2xl font-bold mb-4">Hasil Pencarian untuk "${query}"</h2>`;
                results.forEach((chapter, index) => {
                    const originalIndex = chapters.findIndex(c => c.title === chapter.title);
                    const resultElem = document.createElement('div');
                    resultElem.className = 'mb-4 p-4 bg-white rounded shadow cursor-pointer';
                    resultElem.innerHTML = `<h3 class="font-bold">${chapter.title}</h3><p class="text-sm text-gray-600">Klik untuk membaca...</p>`;
                    resultElem.onclick = () => showChapter(originalIndex);
                    resultsContainer.appendChild(resultElem);
                });
            } else {
                resultsContainer.innerHTML = `<p>Tidak ada hasil untuk "${query}".</p>`;
            }
        }
        
        function startQuiz(type) {
            currentQuestionIndex = 0;
            userAnswers = {};
            if (type === 'multiple-choice') {
                currentQuizData = multipleChoiceQuiz;
                document.getElementById('quiz-title').textContent = 'Kuis Pilihan Ganda';
            } else {
                currentQuizData = essayQuiz;
                document.getElementById('quiz-title').textContent = 'Kuis Esai';
            }
            
            document.getElementById('quiz-modal').style.display = 'block';
            displayQuestion();
        }

        function displayQuestion() {
            const quizContent = document.getElementById('quiz-content');
            const progress = document.getElementById('quiz-progress');
            progress.style.display = 'block';
            const questionData = currentQuizData[currentQuestionIndex];
            
            progress.textContent = `Soal ${currentQuestionIndex + 1} dari ${currentQuizData.length}`;
            
            let html = `<div class="mb-4"><p class="font-semibold text-lg">${currentQuestionIndex + 1}. ${questionData.question}</p></div>`;

            if (questionData.options) { // Multiple choice
                html += `<div id="options-container" class="space-y-3">`;
                questionData.options.forEach((option, index) => {
                    html += `<div id="option-${index}" class="quiz-option p-3 border-2 border-gray-300 rounded-lg" onclick="selectOption(${index}, this)">${option}</div>`;
                });
                html += `</div>`;
                html += `<div id="quiz-feedback" class="p-4 mt-4 rounded-lg"></div>`;

            } else { // Essay
                html += `<textarea id="essay-answer" class="w-full p-2 border rounded-lg" rows="5" placeholder="Tulis jawaban singkatmu di sini..."></textarea>`;
                html += `<button onclick="checkEssayAnswer()" class="mt-2 bg-green-500 text-white font-bold py-2 px-4 rounded-lg">Cek Jawaban</button>`;
                html += `<div id="essay-feedback" class="p-4 mt-4 rounded-lg bg-yellow-100 border border-yellow-300"></div>`;
            }

            quizContent.innerHTML = html;

            if (userAnswers[currentQuestionIndex] !== undefined) {
                 if (questionData.options) {
                    const selectedOptionIndex = userAnswers[currentQuestionIndex];
                    document.getElementById(`option-${selectedOptionIndex}`).classList.add('selected');
                    showFeedback();
                } else {
                    document.getElementById('essay-answer').value = userAnswers[currentQuestionIndex];
                    checkEssayAnswer(); // Show answer again if already answered
                }
            }
            
            updateNavButtons();
        }

        function selectOption(index, element) {
            if(userAnswers[currentQuestionIndex] !== undefined) return;

            userAnswers[currentQuestionIndex] = index;
            showFeedback();
        }

        function showFeedback() {
            const selectedIndex = userAnswers[currentQuestionIndex];
            if (selectedIndex === undefined) return;

            const questionData = currentQuizData[currentQuestionIndex];
            const feedbackElem = document.getElementById('quiz-feedback');
            const allOptions = document.querySelectorAll('.quiz-option');

            allOptions.forEach(opt => opt.onclick = null); // Disable all options

            const correctIndex = questionData.options.indexOf(questionData.answer);
            const correctOptionElem = document.getElementById(`option-${correctIndex}`);
            const selectedOptionElem = document.getElementById(`option-${selectedIndex}`);


            if (selectedIndex === correctIndex) {
                selectedOptionElem.classList.remove('selected');
                selectedOptionElem.classList.add('correct');
                feedbackElem.className = 'p-4 mt-4 rounded-lg bg-green-100 text-green-800';
                feedbackElem.innerHTML = `<strong>Benar!</strong><br>${questionData.explanation}`;
            } else {
                selectedOptionElem.classList.remove('selected');
                selectedOptionElem.classList.add('incorrect');
                correctOptionElem.classList.add('correct');
                feedbackElem.className = 'p-4 mt-4 rounded-lg bg-red-100 text-red-800';
                feedbackElem.innerHTML = `<strong>Salah.</strong> Jawaban yang benar adalah <strong>${questionData.answer}</strong>.<br>${questionData.explanation}`;
            }
            feedbackElem.style.display = 'block';
        }

        function checkEssayAnswer() {
            const userAnswer = document.getElementById('essay-answer').value;
            userAnswers[currentQuestionIndex] = userAnswer;
            const feedbackElem = document.getElementById('essay-feedback');
            const questionData = currentQuizData[currentQuestionIndex];

            feedbackElem.innerHTML = `<strong>Jawaban yang Disarankan:</strong><br>${questionData.answer}<br><br>Bandingkan jawabanmu dengan jawaban di atas.`;
            feedbackElem.style.display = 'block';
        }
        
        function nextQuestion() {
            if (currentQuestionIndex < currentQuizData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                showQuizResult();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function updateNavButtons() {
            document.getElementById('prev-question-btn').style.display = currentQuestionIndex > 0 ? 'block' : 'none';
             document.getElementById('next-question-btn').style.display = 'block';
            if(currentQuestionIndex === currentQuizData.length - 1){
                 document.getElementById('next-question-btn').textContent = 'Lihat Hasil';
            } else {
                 document.getElementById('next-question-btn').textContent = 'Selanjutnya';
            }
        }

        function showQuizResult() {
            const quizContent = document.getElementById('quiz-content');
            document.getElementById('quiz-progress').style.display = 'none';

            let resultHTML = '';
            if (currentQuizData[0].options) { // It's a multiple choice quiz
                 let correctCount = 0;
                 for (let i = 0; i < currentQuizData.length; i++) {
                    const correctIndex = currentQuizData[i].options.indexOf(currentQuizData[i].answer);
                    if (userAnswers[i] === correctIndex) {
                        correctCount++;
                    }
                }
                const score = (correctCount / currentQuizData.length) * 100;
                resultHTML = `
                    <h3 class="text-xl font-bold">Kuis Selesai!</h3>
                    <p class="my-4">Anda menjawab benar ${correctCount} dari ${currentQuizData.length} soal.</p>
                    <p class="text-2xl font-bold">Skor Anda: ${score.toFixed(0)}</p>
                `;
            } else { // Essay quiz
                 resultHTML = `
                    <h3 class="text-xl font-bold">Kuis Esai Selesai!</h3>
                    <p class="my-4">Anda telah menyelesaikan semua soal esai. Silakan tinjau kembali jawaban Anda dan pembahasan yang diberikan dengan menekan tombol 'Sebelumnya'.</p>
                `;
            }
            
            resultHTML += `<button onclick="startQuiz(currentQuizData[0].options ? 'multiple-choice' : 'essay')" class="mt-4 bg-green-500 text-white font-bold py-2 px-4 rounded-lg">Ulangi Kuis</button>
                           <button onclick="closeModal('quiz-modal')" class="mt-4 ml-2 bg-blue-500 text-white font-bold py-2 px-4 rounded-lg">Tutup</button>`;

            quizContent.innerHTML = resultHTML;
           
            document.getElementById('next-question-btn').style.display = 'none';
             document.getElementById('prev-question-btn').style.display = 'block';

        }

    </script>
</body>
</html>
